{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"PESCA PESCA (proportion of population-specific and shared causal variants) is a software package for estimating proportions of population-specific and shared causal variants from GWAS summary statistics. Software requirement For compiling and running PESCA g++ (version 4.7.2) boost C++ library (1.55) BLAS library To compile the PESCA program, please cd into src/ , and then type make . Data Genome partition We provide definitions of regions that are approximately independent in EAS and EUR here . Reference panel Reference panels should be in PLINK format . We provide 1000 Genomes reference panel for EAS and EUR here . All SNPs in this reference panel have minor allele frequency greater than 5% in both populations, and have been LD pruned with \\(R^2\\) threshold of 0.95. Contact Huwenbo Shi : hshi_AT_hsph.harvard.edu Kathy Burch : kathy.s.burch_AT_gmail.com","title":"Home"},{"location":"#pesca","text":"PESCA (proportion of population-specific and shared causal variants) is a software package for estimating proportions of population-specific and shared causal variants from GWAS summary statistics.","title":"PESCA"},{"location":"#software-requirement","text":"","title":"Software requirement"},{"location":"#for-compiling-and-running-pesca","text":"g++ (version 4.7.2) boost C++ library (1.55) BLAS library To compile the PESCA program, please cd into src/ , and then type make .","title":"For compiling and running PESCA"},{"location":"#data","text":"","title":"Data"},{"location":"#genome-partition","text":"We provide definitions of regions that are approximately independent in EAS and EUR here .","title":"Genome partition"},{"location":"#reference-panel","text":"Reference panels should be in PLINK format . We provide 1000 Genomes reference panel for EAS and EUR here . All SNPs in this reference panel have minor allele frequency greater than 5% in both populations, and have been LD pruned with \\(R^2\\) threshold of 0.95.","title":"Reference panel"},{"location":"#contact","text":"Huwenbo Shi : hshi_AT_hsph.harvard.edu Kathy Burch : kathy.s.burch_AT_gmail.com","title":"Contact"},{"location":"faq/","text":"","title":"FAQ"},{"location":"input_format/","text":"Input Format This page describes file formats of GWAS summary statistics data and LD matrix used by PESCA. GWAS summary statistics data GWAS summary statistics data should have the following columns, ordered as listed below. SNP : rs ID of the SNP (e.g. rs62442) BP : Chromosome number of the SNP. This should be a number between 1 and 22. A2 : Effect allele (i.e. trait increasing allele) of the SNP. The sign of Z-score is with respect to this allele. A1 : The other allele of the SNP. Z : Z-score of the SNP. N : Sample size. The following is an example of GWAS summary statistics file. SNP BP A2 A1 Z N rs131529 16870162 A G 0.985754 50000 rs131538 16871137 G A 1.382624 50000 rs131545 16871951 G A 1.304881 50000 rs140375 16873251 C A 1.494041 50000 rs131566 16879530 G A 0.981185 50000 ... ... ... ... ... ... There should be a GWAS summary statistics file for each non-overlapping region. GWAS summary statistics data list file GWAS summary statistics data list file contains a list of paths to GWAS summary statistics data split by region. Typically, there should be one such list file for each chromosome and each population. A lsit of GWAS summary statistics files can be specified to PESCA through the --zscore1 and --zscore2 (one flag for each population) flags. The following is an example of GWAS summary statistics data list file. /<path>/<to>/<GWAS>/<summary>/<data>/region1_zscore_pop1.txt /<path>/<to>/<GWAS>/<summary>/<data>/region2_zscore_pop1.txt ... /<path>/<to>/<GWAS>/<summary>/<data>/region100_zscore_pop1.txt ... LD matrix The LD matrix file is a text file that stores the LD matrix of a region. Each LD matrix file should correspond to a GWAS summary statistics file of a region. There should be M lines and M columns in the LD matrix file, where M is the number of SNPs in the region. The following is an example of a LD matrix file. 1 0.964359 -0.0862651 -0.0846509 -0.0339536 ... 0.964359 1 -0.0655564 -0.0446302 -0.0588997 ... -0.0862651 -0.0655564 1 0.859188 0.0562084 ... -0.0846509 -0.0446302 0.859188 1 0.048621 ... -0.0339536 -0.0588997 0.0562084 0.048621 1 ... ... ... ... ... ... LD matrix list file LD matrix list file contains a list of paths to LD matrices split by region. Typically, there should be one such list file for each chromosome and each population. LD matrix list files can be specified to PESCA through the --ld1 and --ld2 (one flag for each population) flags. The following is an example of LD matrixlist file. /<path>/<to>/<GWAS>/<summary>/<data>/region1_ld_pop1.txt /<path>/<to>/<GWAS>/<summary>/<data>/region2_ld_pop1.txt ... /<path>/<to>/<GWAS>/<summary>/<data>/region100_ld_pop1.txt ... LD matrix list files can be specified to PESCA through the --ld1 and --ld2 flags (one flag for each population). ( Note : Each line in the list of LD matrix file should correpond to a line in the list of GWAS summary statistics file. )","title":"Input Format"},{"location":"input_format/#input-format","text":"This page describes file formats of GWAS summary statistics data and LD matrix used by PESCA.","title":"Input Format"},{"location":"input_format/#gwas-summary-statistics-data","text":"GWAS summary statistics data should have the following columns, ordered as listed below. SNP : rs ID of the SNP (e.g. rs62442) BP : Chromosome number of the SNP. This should be a number between 1 and 22. A2 : Effect allele (i.e. trait increasing allele) of the SNP. The sign of Z-score is with respect to this allele. A1 : The other allele of the SNP. Z : Z-score of the SNP. N : Sample size. The following is an example of GWAS summary statistics file. SNP BP A2 A1 Z N rs131529 16870162 A G 0.985754 50000 rs131538 16871137 G A 1.382624 50000 rs131545 16871951 G A 1.304881 50000 rs140375 16873251 C A 1.494041 50000 rs131566 16879530 G A 0.981185 50000 ... ... ... ... ... ... There should be a GWAS summary statistics file for each non-overlapping region.","title":"GWAS summary statistics data"},{"location":"input_format/#gwas-summary-statistics-data-list-file","text":"GWAS summary statistics data list file contains a list of paths to GWAS summary statistics data split by region. Typically, there should be one such list file for each chromosome and each population. A lsit of GWAS summary statistics files can be specified to PESCA through the --zscore1 and --zscore2 (one flag for each population) flags. The following is an example of GWAS summary statistics data list file. /<path>/<to>/<GWAS>/<summary>/<data>/region1_zscore_pop1.txt /<path>/<to>/<GWAS>/<summary>/<data>/region2_zscore_pop1.txt ... /<path>/<to>/<GWAS>/<summary>/<data>/region100_zscore_pop1.txt ...","title":"GWAS summary statistics data list file"},{"location":"input_format/#ld-matrix","text":"The LD matrix file is a text file that stores the LD matrix of a region. Each LD matrix file should correspond to a GWAS summary statistics file of a region. There should be M lines and M columns in the LD matrix file, where M is the number of SNPs in the region. The following is an example of a LD matrix file. 1 0.964359 -0.0862651 -0.0846509 -0.0339536 ... 0.964359 1 -0.0655564 -0.0446302 -0.0588997 ... -0.0862651 -0.0655564 1 0.859188 0.0562084 ... -0.0846509 -0.0446302 0.859188 1 0.048621 ... -0.0339536 -0.0588997 0.0562084 0.048621 1 ... ... ... ... ... ...","title":"LD matrix"},{"location":"input_format/#ld-matrix-list-file","text":"LD matrix list file contains a list of paths to LD matrices split by region. Typically, there should be one such list file for each chromosome and each population. LD matrix list files can be specified to PESCA through the --ld1 and --ld2 (one flag for each population) flags. The following is an example of LD matrixlist file. /<path>/<to>/<GWAS>/<summary>/<data>/region1_ld_pop1.txt /<path>/<to>/<GWAS>/<summary>/<data>/region2_ld_pop1.txt ... /<path>/<to>/<GWAS>/<summary>/<data>/region100_ld_pop1.txt ... LD matrix list files can be specified to PESCA through the --ld1 and --ld2 flags (one flag for each population). ( Note : Each line in the list of LD matrix file should correpond to a line in the list of GWAS summary statistics file. )","title":"LD matrix list file"},{"location":"posterior/","text":"Estimating posterior probabilities of each SNP being population-specific and shared This page describes the pipeline to estimate the posterior probabilities of a SNP being population-specific and shared. Step 0: estimate genome-wide prior probabilities This step should be performend following steps described here . Step 1: estimate per-SNP posterior probabilities PESCA estimates per-SNP posterior probabilities of each SNP beling population-specific and shared via the following command. This step could be run for each chromosome in parallel. <directory to pesca>/pesca \\ --mode post \\ --f00 <MVB f00 parameter from step 0> \\ --f01 <MVB f00 parameter from step 0> \\ --f10 <MVB f00 parameter from step 0> \\ --f11 <MVB f00 parameter from step 0> \\ --zscore1 <list of GWAS summary statistics files for population 1> \\ --zscore2 <list of GWAS summary statistics files for population 2> \\ --ld1 <list of LD files for population 1> \\ --ld2 <list of LD files for population 2> \\ --nburn <number of MCMC burn-ins, 5000 by default> \\ --nsample <number of MCMC samples, 5000 by default> \\ --lambda <shrinkage parameter> \\ --sigmasq1 <sample size times heritability in population 1> \\ --sigmasq2 <sample size times heritability in population 1> \\ --totnsnp <total number of SNPs across all chromosomes> \\ --max_iter <number of independent MCMC chains> \\ --out <output file name>_chr<chromosome #> Here are the meaning of the flags: --mode tells PESCA whether to estimate genome-wide prior or per-SNP posterior probabilities. There are two options for this flag fit and post . post tells PESCA to estimate posteriors. For estimating priors see here . f00 , f01 , f10 , f11 are multivariate Bernoulli (MVB) model parameters. This estimates should be obtained from step 0. --zscore1 specifies a text file containing a list of paths to GWAS summary statistics for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --zscore2 specifies a text file containing a list of paths to GWAS summary statistics for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --ld1 specifies a text file containing a list of paths to LD matrices for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore1 flag. --ld2 specifies a text file containing a list of paths to LD matrices for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore2 flag. --nburn specifies the number of burn-ins for the MCMC. The default is 5000. --nsample specifies the number of samples for the MCMC. The default is 5000. --sigmasq1 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 1 multiplied by sample size of the GWAS in population 1. --sigmasq2 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 2 multiplied by sample size of the GWAS in population 2. --totnsnp specifies total number of SNPs across all chromosomes. ( Note : This is the number of SNPs after intersecting with the reference panels, which have been MAF filtered and LD pruned. ) --max_iter specifies the number of independent MCMC chains to estimate posteriors. PESCA uses the average posteriors as the final posteriors. We recommend setting this value to 20. --out specifies the output file name. The following is an example output, <output file name>_chr<chromosome #>.txt . SNP BP A0_GWAS1 A1_GWAS1 Z_GWAS1 A0_GWAS2 A1_GWAS2 Z_GWAS2 P_GWAS1_ONLY P_GWAS2_ONLY P_BOTH rs12567000 101242593 C T -0.669797 C T -1.20845 0.00013 0 0.0736 rs12404364 101255697 T C 1.40208 T C 1.45765 0 0.00016 0.10239 rs12043207 101302813 A G -0.720678 A G 0.356864 0 0 0.05533 rs7541397 101322866 G A -2.03966 G A -3.05884 0.01002 0.00356 0.4613 rs3737581 101341083 G A -0.879881 G A 0.411767 0.0005 0 0.08021 ... ... ... ... ... ... ... ... ... ... ... SNP is the ID of the SNP. BP is the base pair position of the SNP. A0_GWAS1 is the non-effect allele of GWAS in population 1. A1_GWAS1 is the effect allele of GWAS in population 1. Z_GWAS1 is the Z-score of GWAS in population 1. A0_GWAS2 is the non-effect allele of GWAS in population 2. A1_GWAS2 is the effect allele of GWAS in population 2. Z_GWAS2 is the Z-score of GWAS in population 2. P_GWAS1_ONLY is the posterior probability that the SNP is causal only in population 1. P_GWAS2_ONLY is the posterior probability that the SNP is causal only in population 2. P_BOTH is the posterior probability that the SNP is causal in both populations.","title":"Estimating per-SNP posteriors"},{"location":"posterior/#estimating-posterior-probabilities-of-each-snp-being-population-specific-and-shared","text":"This page describes the pipeline to estimate the posterior probabilities of a SNP being population-specific and shared.","title":"Estimating posterior probabilities of each SNP being population-specific and shared"},{"location":"posterior/#step-0-estimate-genome-wide-prior-probabilities","text":"This step should be performend following steps described here .","title":"Step 0: estimate genome-wide prior probabilities"},{"location":"posterior/#step-1-estimate-per-snp-posterior-probabilities","text":"PESCA estimates per-SNP posterior probabilities of each SNP beling population-specific and shared via the following command. This step could be run for each chromosome in parallel. <directory to pesca>/pesca \\ --mode post \\ --f00 <MVB f00 parameter from step 0> \\ --f01 <MVB f00 parameter from step 0> \\ --f10 <MVB f00 parameter from step 0> \\ --f11 <MVB f00 parameter from step 0> \\ --zscore1 <list of GWAS summary statistics files for population 1> \\ --zscore2 <list of GWAS summary statistics files for population 2> \\ --ld1 <list of LD files for population 1> \\ --ld2 <list of LD files for population 2> \\ --nburn <number of MCMC burn-ins, 5000 by default> \\ --nsample <number of MCMC samples, 5000 by default> \\ --lambda <shrinkage parameter> \\ --sigmasq1 <sample size times heritability in population 1> \\ --sigmasq2 <sample size times heritability in population 1> \\ --totnsnp <total number of SNPs across all chromosomes> \\ --max_iter <number of independent MCMC chains> \\ --out <output file name>_chr<chromosome #> Here are the meaning of the flags: --mode tells PESCA whether to estimate genome-wide prior or per-SNP posterior probabilities. There are two options for this flag fit and post . post tells PESCA to estimate posteriors. For estimating priors see here . f00 , f01 , f10 , f11 are multivariate Bernoulli (MVB) model parameters. This estimates should be obtained from step 0. --zscore1 specifies a text file containing a list of paths to GWAS summary statistics for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --zscore2 specifies a text file containing a list of paths to GWAS summary statistics for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --ld1 specifies a text file containing a list of paths to LD matrices for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore1 flag. --ld2 specifies a text file containing a list of paths to LD matrices for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore2 flag. --nburn specifies the number of burn-ins for the MCMC. The default is 5000. --nsample specifies the number of samples for the MCMC. The default is 5000. --sigmasq1 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 1 multiplied by sample size of the GWAS in population 1. --sigmasq2 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 2 multiplied by sample size of the GWAS in population 2. --totnsnp specifies total number of SNPs across all chromosomes. ( Note : This is the number of SNPs after intersecting with the reference panels, which have been MAF filtered and LD pruned. ) --max_iter specifies the number of independent MCMC chains to estimate posteriors. PESCA uses the average posteriors as the final posteriors. We recommend setting this value to 20. --out specifies the output file name. The following is an example output, <output file name>_chr<chromosome #>.txt . SNP BP A0_GWAS1 A1_GWAS1 Z_GWAS1 A0_GWAS2 A1_GWAS2 Z_GWAS2 P_GWAS1_ONLY P_GWAS2_ONLY P_BOTH rs12567000 101242593 C T -0.669797 C T -1.20845 0.00013 0 0.0736 rs12404364 101255697 T C 1.40208 T C 1.45765 0 0.00016 0.10239 rs12043207 101302813 A G -0.720678 A G 0.356864 0 0 0.05533 rs7541397 101322866 G A -2.03966 G A -3.05884 0.01002 0.00356 0.4613 rs3737581 101341083 G A -0.879881 G A 0.411767 0.0005 0 0.08021 ... ... ... ... ... ... ... ... ... ... ... SNP is the ID of the SNP. BP is the base pair position of the SNP. A0_GWAS1 is the non-effect allele of GWAS in population 1. A1_GWAS1 is the effect allele of GWAS in population 1. Z_GWAS1 is the Z-score of GWAS in population 1. A0_GWAS2 is the non-effect allele of GWAS in population 2. A1_GWAS2 is the effect allele of GWAS in population 2. Z_GWAS2 is the Z-score of GWAS in population 2. P_GWAS1_ONLY is the posterior probability that the SNP is causal only in population 1. P_GWAS2_ONLY is the posterior probability that the SNP is causal only in population 2. P_BOTH is the posterior probability that the SNP is causal in both populations.","title":"Step 1: estimate per-SNP posterior probabilities"},{"location":"prior/","text":"Estimating genome-wide proportion of population-specific and shared causal variants This page describes the pipeline to estimate the genome-wide prior probabilities of a SNP to be causal in one population (i.e. population-specific) or in both populations (i.e. shared). Step 0: estimate genome-wide heritability of the trait This step can be performend using LDSC . ( Note : This step should be performed using all SNPs without any MAF filtering or LD pruning, except for those required by LDSC. ) Step 1: extract summary statistics and LD of each region for each chromosome In this step, one Intersects the GWAS summary statistics with the reference panel. We provide reference panels in PLINK format for East Asians and Europeans here . This reference panel contains LD pruned SNPs (\\(R^2 > 0.95\\)) with MAF greater than 5% in both populations. Splits GWAS summary statistics data into regions for each chromosome. Format of the GWAS summary statistics data used by PESCA can be found here . Computes the corresponding LD matrix of each region. We provide region definitions that are approximately LD-independent across East Asians and Europeans here . Format of LD matrix can be found here . We recommend using the following directory organization. < trait name >/ chr1 / chr1_region1_zscore_pop1 . txt chr1_region1_zscore_pop2 . txt chr1_region1_ld_pop1 . txt chr1_region1_ld_pop2 . txt ... chr1_region100_zscore_pop1 . txt chr1_region100_zscore_pop2 . txt chr1_region100_ld_pop1 . txt chr1_region100_ld_pop2 . txt ... chr1_zscore_list_pop1 . txt chr1_zscore_list_pop2 . txt chr1_ld_list_pop1 . txt chr1_ld_list_pop2 . txt chr2 / ... ... chr22 / ... chr1_region1_zscore_pop1.txt and chr1_region2_zscore_pop2.txt are the GWAS summary statistics data files in chromosome 1 region 1 for population 1 and 2 respectively (see here for format). chr1_region1_ld_pop1.txt and chr1_region1_ld_pop2.txt are the corresponding LD matrices (see here for format). chr1_zscore_list_pop1.txt is a list of paths to all the chr1_region*_zscore_pop1.txt files, i.e. GWAS summary statistics data in all regions on chromosome 1 for population 1. chr1_zscore_list_pop2.txt is a list of paths to all the chr1_region*_zscore_pop2.txt files. chr1_ld_list_pop1.txt is a list of paths to all the chr1_region*_ld_pop1.txt files, i.e. LD matrices for all regions on chromosome 1 for population 1. chr1_ld_list_pop2.txt is a list of paths to all the chr1_region*_ld_pop2.txt files. Step 2: run PESCA for each chromosome PESCA estimates genome-wide proportions of population-specific and shared causal variants via the following command. This step could be run for each chromosome in parallel. < directory to pesca >/ pesca \\ -- mode fit \\ -- zscore1 < list of GWAS summary statistics files for population 1 > \\ -- zscore2 < list of GWAS summary statistics files for population 2 > \\ -- ld1 < list of LD files for population 1 > \\ -- ld2 < list of LD files for population 2 > \\ -- nburn < number of MCMC burn - ins , 5000 by default > \\ -- nsample < number of MCMC samples , 5000 by default > \\ -- lambda < shrinkage parameter , 0 . 0001 by default > \\ -- sigmasq1 < sample size times heritability in population 1 > \\ -- sigmasq2 < sample size times heritability in population 1 > \\ -- totnsnp < total number of SNPs across all chromosomes > \\ -- max_iter < maximum number of EM iterations > \\ -- out < output file name > _chr < chromosome # > Here are the meaning of the flags: --mode tells PESCA whether to estimate genome-wide prior or per-SNP posterior probabilities. There are two options for this flag fit and post . fit tells PESCA to estimate priors. For estimating per-SNP posterior see here . --zscore1 specifies a text file containing a list of paths to GWAS summary statistics for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --zscore2 specifies a text file containing a list of paths to GWAS summary statistics for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --ld1 specifies a text file containing a list of paths to LD matrices for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore1 flag. --ld2 specifies a text file containing a list of paths to LD matrices for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore2 flag. --nburn specifies the number of burn-ins for the MCMC. The default is 5000. --nsample specifies the number of samples for the MCMC. The default is 5000. --sigmasq1 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 1 multiplied by sample size of the GWAS in population 1. --sigmasq2 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 2 multiplied by sample size of the GWAS in population 2. --totnsnp specifies total number of SNPs across all chromosomes. ( Note : This is the number of SNPs after intersecting with the reference panels, which have been MAF filtered and LD pruned. ) --max_iter specifies maximum number of EM iterations. The default is 200. --out specifies the output file name. The following is an example output, <output file name>_chr<chromosome #>.log . iter nsnp q00 q01 q10 q11 f00 f01 f10 f11 0 9960 9389.8 190.067 190.067 190.067 0 -3.9 -3.9 3.9 1 9960 9433.58 177.374 184.488 164.561 0 -3.97377 -3.93445 3.85947 2 9960 9466.98 164.664 187.16 141.2 0 -4.05166 -3.9236 3.76987 3 9960 9478.17 164.541 173.529 143.756 0 -4.05359 -4.0004 3.86536 4 9960 9502.39 164.518 157.391 135.704 0 -4.05628 -4.10056 3.90802 5 9960 9524.52 154.285 154.576 126.616 0 -4.12283 -4.12094 3.9233 ... ... ... ... ... ... ... ... ... ... iter is the iteration number of the EM algorithm. nsnp is the total number of SNPs. q00 is the number of SNPs that are causal in neither population. q01 is the number of SNPs that are causal in population 1. q10 is the number of SNPs that are causal in population 2. q11 is the number of SNPs that are causal in both populations. f00 , f01 , and f10 , and f11 are parameters of the multivariate Bernoulli (MVB) model. We use results from the last EM iteration as the final estimates. Step 3: aggregate results from all chromosomes After step 2, there should be one <output file name>_chr<chromosome #>.log for each chromosome. To aggregate results from step 2 across chromosomes, we provide parse_prior.py . This script uses the average of the last 50 iterations of the log file to estimate genome-wide number of null SNPs (not causal in both populations), population 1 specific causal SNPs, population 2 specific causal SNPs, and shared causal SNPs. The script can be run as follows. python3 < path to script >/ parse_prior . py \\ --prefix <path to results from step 2>/<output file name>_chr The following is an example output. number of SNPs q00 235640.05 q01 275.53 q10 376.20 q11 21838.23 MVB parameters f00 0.0000 f01 -6.7514 f10 -6.4399 f11 10.8127 The MVB parameters will be used for estimating the posterior probabilities .","title":"Estimating genome-wide priors"},{"location":"prior/#estimating-genome-wide-proportion-of-population-specific-and-shared-causal-variants","text":"This page describes the pipeline to estimate the genome-wide prior probabilities of a SNP to be causal in one population (i.e. population-specific) or in both populations (i.e. shared).","title":"Estimating genome-wide proportion of population-specific and shared causal variants"},{"location":"prior/#step-0-estimate-genome-wide-heritability-of-the-trait","text":"This step can be performend using LDSC . ( Note : This step should be performed using all SNPs without any MAF filtering or LD pruning, except for those required by LDSC. )","title":"Step 0: estimate genome-wide heritability of the trait"},{"location":"prior/#step-1-extract-summary-statistics-and-ld-of-each-region-for-each-chromosome","text":"In this step, one Intersects the GWAS summary statistics with the reference panel. We provide reference panels in PLINK format for East Asians and Europeans here . This reference panel contains LD pruned SNPs (\\(R^2 > 0.95\\)) with MAF greater than 5% in both populations. Splits GWAS summary statistics data into regions for each chromosome. Format of the GWAS summary statistics data used by PESCA can be found here . Computes the corresponding LD matrix of each region. We provide region definitions that are approximately LD-independent across East Asians and Europeans here . Format of LD matrix can be found here . We recommend using the following directory organization. < trait name >/ chr1 / chr1_region1_zscore_pop1 . txt chr1_region1_zscore_pop2 . txt chr1_region1_ld_pop1 . txt chr1_region1_ld_pop2 . txt ... chr1_region100_zscore_pop1 . txt chr1_region100_zscore_pop2 . txt chr1_region100_ld_pop1 . txt chr1_region100_ld_pop2 . txt ... chr1_zscore_list_pop1 . txt chr1_zscore_list_pop2 . txt chr1_ld_list_pop1 . txt chr1_ld_list_pop2 . txt chr2 / ... ... chr22 / ... chr1_region1_zscore_pop1.txt and chr1_region2_zscore_pop2.txt are the GWAS summary statistics data files in chromosome 1 region 1 for population 1 and 2 respectively (see here for format). chr1_region1_ld_pop1.txt and chr1_region1_ld_pop2.txt are the corresponding LD matrices (see here for format). chr1_zscore_list_pop1.txt is a list of paths to all the chr1_region*_zscore_pop1.txt files, i.e. GWAS summary statistics data in all regions on chromosome 1 for population 1. chr1_zscore_list_pop2.txt is a list of paths to all the chr1_region*_zscore_pop2.txt files. chr1_ld_list_pop1.txt is a list of paths to all the chr1_region*_ld_pop1.txt files, i.e. LD matrices for all regions on chromosome 1 for population 1. chr1_ld_list_pop2.txt is a list of paths to all the chr1_region*_ld_pop2.txt files.","title":"Step 1: extract summary statistics and LD of each region for each chromosome"},{"location":"prior/#step-2-run-pesca-for-each-chromosome","text":"PESCA estimates genome-wide proportions of population-specific and shared causal variants via the following command. This step could be run for each chromosome in parallel. < directory to pesca >/ pesca \\ -- mode fit \\ -- zscore1 < list of GWAS summary statistics files for population 1 > \\ -- zscore2 < list of GWAS summary statistics files for population 2 > \\ -- ld1 < list of LD files for population 1 > \\ -- ld2 < list of LD files for population 2 > \\ -- nburn < number of MCMC burn - ins , 5000 by default > \\ -- nsample < number of MCMC samples , 5000 by default > \\ -- lambda < shrinkage parameter , 0 . 0001 by default > \\ -- sigmasq1 < sample size times heritability in population 1 > \\ -- sigmasq2 < sample size times heritability in population 1 > \\ -- totnsnp < total number of SNPs across all chromosomes > \\ -- max_iter < maximum number of EM iterations > \\ -- out < output file name > _chr < chromosome # > Here are the meaning of the flags: --mode tells PESCA whether to estimate genome-wide prior or per-SNP posterior probabilities. There are two options for this flag fit and post . fit tells PESCA to estimate priors. For estimating per-SNP posterior see here . --zscore1 specifies a text file containing a list of paths to GWAS summary statistics for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --zscore2 specifies a text file containing a list of paths to GWAS summary statistics for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to GWAS summary statistics of one region on that chromosome. See here for format of GWAS summary statistics data for PESCA. --ld1 specifies a text file containing a list of paths to LD matrices for population 1, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore1 flag. --ld2 specifies a text file containing a list of paths to LD matrices for population 2, one path per line. Typically, there should be one such text file for each chromosome. And each line in the text file corresponds to LD matrix of one region on that chromosome. Additionally, each line in the text file should correspond to the same region listed by the --zscore2 flag. --nburn specifies the number of burn-ins for the MCMC. The default is 5000. --nsample specifies the number of samples for the MCMC. The default is 5000. --sigmasq1 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 1 multiplied by sample size of the GWAS in population 1. --sigmasq2 specifies genome-wide SNP-heritability (e.g. estimated by LDSC) for population 2 multiplied by sample size of the GWAS in population 2. --totnsnp specifies total number of SNPs across all chromosomes. ( Note : This is the number of SNPs after intersecting with the reference panels, which have been MAF filtered and LD pruned. ) --max_iter specifies maximum number of EM iterations. The default is 200. --out specifies the output file name. The following is an example output, <output file name>_chr<chromosome #>.log . iter nsnp q00 q01 q10 q11 f00 f01 f10 f11 0 9960 9389.8 190.067 190.067 190.067 0 -3.9 -3.9 3.9 1 9960 9433.58 177.374 184.488 164.561 0 -3.97377 -3.93445 3.85947 2 9960 9466.98 164.664 187.16 141.2 0 -4.05166 -3.9236 3.76987 3 9960 9478.17 164.541 173.529 143.756 0 -4.05359 -4.0004 3.86536 4 9960 9502.39 164.518 157.391 135.704 0 -4.05628 -4.10056 3.90802 5 9960 9524.52 154.285 154.576 126.616 0 -4.12283 -4.12094 3.9233 ... ... ... ... ... ... ... ... ... ... iter is the iteration number of the EM algorithm. nsnp is the total number of SNPs. q00 is the number of SNPs that are causal in neither population. q01 is the number of SNPs that are causal in population 1. q10 is the number of SNPs that are causal in population 2. q11 is the number of SNPs that are causal in both populations. f00 , f01 , and f10 , and f11 are parameters of the multivariate Bernoulli (MVB) model. We use results from the last EM iteration as the final estimates.","title":"Step 2: run PESCA for each chromosome"},{"location":"prior/#step-3-aggregate-results-from-all-chromosomes","text":"After step 2, there should be one <output file name>_chr<chromosome #>.log for each chromosome. To aggregate results from step 2 across chromosomes, we provide parse_prior.py . This script uses the average of the last 50 iterations of the log file to estimate genome-wide number of null SNPs (not causal in both populations), population 1 specific causal SNPs, population 2 specific causal SNPs, and shared causal SNPs. The script can be run as follows. python3 < path to script >/ parse_prior . py \\ --prefix <path to results from step 2>/<output file name>_chr The following is an example output. number of SNPs q00 235640.05 q01 275.53 q10 376.20 q11 21838.23 MVB parameters f00 0.0000 f01 -6.7514 f10 -6.4399 f11 10.8127 The MVB parameters will be used for estimating the posterior probabilities .","title":"Step 3: aggregate results from all chromosomes"}]}